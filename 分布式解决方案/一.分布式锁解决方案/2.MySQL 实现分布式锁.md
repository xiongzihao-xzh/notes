# MySQL 悲观锁-单条 update 语句问题
> 即把代码中查询逻辑、判断逻辑、更新逻辑合并为一条 SQL 语句

* 易造成锁范围过大（加唯一索引可以解决）
* 无法拿到更新前的数据
* 很多场景下无法满足业务需求
# MySQL 悲观锁-for update 语句问题
* 易造成锁范围过大（加唯一索引可以解决）
* 性能较差
* 死锁问题
* select for update 和普通 select 语句读取内容不一致（for update 使用的是当前读）
# MySQL 乐观锁实现-版本号
* 给数据库表增加一列 "version"
* 读取数据的时候，将 "version" 字段一并读出
* 数据每更新一次，"version" 字段加一
* 提交更新时，判断库中的 "version" 字段值和之前取出来的 "version" 比较
* 如果和之前的 "version" 不一样，则重试
# MySQL 乐观锁问题
* 高并发写操作下性能低
* 存在 ABA 问题（乐观锁都存在的问题）
* 乐观锁适合读多写少的场景